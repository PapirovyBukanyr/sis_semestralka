# SIS Semestralka Documentation

 Author: Marek PÅ™ibyl

 This document was autogenerated by tools/gen_docs.py. 
 
Organizing files by top-level (receiver/sender) and modules.


# receiver


## module1


### receiver/module1/data_processor.c


| Module | Functions |
|---|---|
| module1 | *preproc_thread, convert_data, convert_json_to_datapoint, parse_data, process_input |

#### *preproc_thread


```text
Preprocessing thread for the pipeline.

Reads raw lines from `raw_queue`, attempts to parse them into
`data_point_t` and forwards either a CSV-formatted string expected by the
NN thread or the original raw line to `proc_queue`.

@param arg unused thread argument
@return NULL
```

#### convert_data


```text
Convert parsed data into the target representation.

Placeholder used by the example parsing pipeline.

@param parsed_data parsed input string
```

#### convert_json_to_datapoint


```text
Convert a JSON-like string to a data_point_t using the parser helpers.

Returns 1 when at least one numeric field was present, 0 otherwise.

@param s input JSON-like string
@param d output datapoint
@return 1 on success (some numeric data found), 0 otherwise
```

#### parse_data


```text
Parse a raw input string.

This example function demonstrates how raw input could be parsed. It
currently forwards the parsed content to `convert_data` for conversion.

@param raw_data input string (NUL-terminated)
```

#### process_input


```text
Process an input file line-by-line.

Example utility that reads `input_file` and calls `parse_data` for each
line. This helper is used during local testing and is not required for the
network receiver pipeline.

@param input_file path to an input text file
```

### receiver/module1/data_processor.h


| Module | Functions |
|---|---|
| module1 | DATA_PROCESSOR_H |

#### DATA_PROCESSOR_H


```text
data_processor.h

Declarations for data processing functions in module1.
```

### receiver/module1/parser.c


| Module | Functions |
|---|---|
| module1 | find_json_number, parse_json_to_datapoint |

#### find_json_number


```text
Locate a numeric value after a JSON key name.

Searches for `key` in `s`, finds the following ':' and attempts to parse
a floating-point number. This helper is intentionally permissive and used
for lightweight JSON-like extraction in the receiver pipeline.

@param s input string to search
@param key key name to find (e.g. "\"timestamp\"")
@param out pointer receiving the parsed double when found
@return 1 if a numeric value was found and parsed, 0 otherwise
```

#### parse_json_to_datapoint


```text
Parse a lightweight JSON-like string into a data_point_t.

Fields that cannot be found are left as NaN so callers can detect missing
values. Supported keys: timestamp, export_bytes, export_flows,
export_packets, export_rtr, export_rtt, export_srt. Matching accepts keys
with or without surrounding quotes.

@param s input NUL-terminated string containing JSON-like content
@param d output pointer to data_point_t (will be written with parsed values or NaN)
```

### receiver/module1/parser.h


| Module | Functions |
|---|---|
| module1 | MODULE1_PARSER_H |

#### MODULE1_PARSER_H


```text
parser.h

Declarations for JSON parsing functions in module1.
```

## module2


### receiver/module2/h_layer.c


| Module | Functions |
|---|---|
| module2 | <stdlib.h>, h_layer_create, h_layer_forward, h_layer_free, h_layer_read, h_layer_write |

#### <stdlib.h>


```text
h_layer.c

Implementation of the hidden-layer container used by the neural-network
module. Provides creation, destruction, forward pass and
serialization/deserialization helpers.
```

#### h_layer_create


```text
Create a new hidden layer with specified number of neurons and input length.

@param n_neurons number of neurons in the layer
@param input_len number of inputs per neuron

@return pointer to allocated h_layer_t or NULL on error
```

#### h_layer_forward


```text
Forward pass through the hidden layer.

@param L pointer to hidden layer
@param input input array of length L->input_len
@param output preallocated output array of length L->n_neurons
```

#### h_layer_free


```text
Free a hidden layer and all its neurons.

@param L pointer previously returned by h_layer_create (may be NULL)
```

#### h_layer_read


```text
Read a hidden layer from a file.

@param f open FILE* for reading
@param L pointer to hidden layer (must be preallocated with matching sizes)
@return 0 on success, -1 on error
```

#### h_layer_write


```text
Write a hidden layer to a file.

@param f open FILE* for writing
@param L pointer to hidden layer
@return 0 on success, -1 on error
```

### receiver/module2/h_layer.h


| Module | Functions |
|---|---|
| module2 | H_LAYER_H |

#### H_LAYER_H


```text
h_layer.h

Declarations for the hidden layer structure and functions used in module2.
```

### receiver/module2/neuron.c


| Module | Functions |
|---|---|
| module2 | <stdlib.h>, drand_unit, neuron_create, neuron_forward, neuron_free, neuron_read, neuron_update, neuron_write |

#### <stdlib.h>


```text
neuron.c

Neuron implementation: activation, parameter storage, serialization and
helper functions used by the hidden-layer implementation.
```

#### drand_unit


```text
Generate a random double in [-1.0, 1.0]

@return random double in [-1.0, 1.0]
```

#### neuron_create


```text
Create and initialize a new neuron with random weights.

@param in_len number of inputs to the neuron
@return pointer to allocated neuron_t or NULL on error
```

#### neuron_forward


```text
Compute neuron output: V = A*B + C (dot product + bias)

@param n pointer to neuron
@param input input array of length n->in_len
@return output value
```

#### neuron_free


```text
Free a neuron and its resources.
```

#### neuron_read


```text
Read a neuron from a file.

@param f file pointer opened for reading
@param n pointer to neuron (must be preallocated with correct in_len)
@return 0 on success, -1 on error
```

#### neuron_update


```text
Update neuron weights using gradient descent.

@param n pointer to neuron
@param input input array of length n->in_len
@param grad_out gradient w.r.t. output (dL/dV)
@param lr learning rate
```

#### neuron_write


```text
Write a neuron to a file.

@param f file pointer opened for writing
@param n pointer to neuron
@return 0 on success, -1 on error
```

### receiver/module2/neuron.h


| Module | Functions |
|---|---|
| module2 | NEURON_H |

#### NEURON_H


```text
neuron.h

Declarations for the neuron structure and functions used in module2.
```

### receiver/module2/nn.c


| Module | Functions |
|---|---|
| module2 |  |

### receiver/module2/nn.h


| Module | Functions |
|---|---|
| module2 | NN_H |

#### NN_H


```text
nn.h

Declarations for the neural network interface used in module2.
```

### receiver/module2/nn_impl.c


| Module | Functions |
|---|---|
| module2 | nn_create, nn_free, nn_load_weights, nn_predict_and_maybe_train, nn_save_weights, nn_s{, skip_layer |

#### nn_create


```text
Create and initialize a new neural network instance.

The function allocates the nn_t structure, creates hidden and output
layers according to provided parameters and attempts to load saved
weights from disk. On failure it returns NULL.

@param p_in pointer to nn_params_t with desired configuration
@return pointer to allocated nn_t or NULL on error
```

#### nn_free


```text
Free a neural network instance and persist weights.

Attempts to save weights to disk (best-effort) and frees all allocated
substructures owned by `nn`.

@param nn pointer previously returned by nn_create
```

#### nn_load_weights


```text
Load network weights from a binary file into `nn` if compatible.

The loader accepts files containing a prefix of hidden layers matching the
in-memory network and an optional output layer. Mismatches are reported
and loading fails gracefully.

@param nn network instance to load into
@param filename path of the weight file to read
@return 0 on success (at least some layers loaded), -1 on error
```

#### nn_predict_and_maybe_train


```text
Predict (and optionally train) the neural network for a datapoint.

The function accepts raw `data_point_t` input, normalizes it, runs a
forward pass and, if `target_raw` is non-NULL, performs an online
training update using `target_raw` as the desired raw outputs. After the
operation the predicted (denormalized) outputs are written into `out_raw`.

@param nn network instance
@param in pointer to input datapoint (raw values)
@param target_raw optional pointer to target raw outputs (length OUTPUT_SIZE) or NULL
@param out_raw output buffer (length OUTPUT_SIZE) receiving denormalized prediction
@return Euclidean cost after training if training occurred, otherwise NaN
```

#### nn_save_weights


```text
Save network weights to a binary file.

The function attempts to create a parent directory (if present in the
filename) and writes a simple representation of the network (layer sizes
followed by per-neuron weight/bias arrays).

@param nn network instance
@param filename path to write the weight file
@return 0 on success, -1 on error
```

#### nn_s{


```text
Neural network structure definition.

nn_params_t params: network parameters
size_t *neurons_per_layer: array of neuron counts per hidden layer
size_t n_layers: number of hidden layers
h_layer_t **layers: array of hidden layers
h_layer_t *output_layer: output layer
```

#### skip_layer


```text
Skip a serialized h_layer entry in a file.

Used when the on-disk model contains more layers than the in-memory
network: this helper advances the file pointer over one layer's data.

@param fp open FILE* positioned at the start of an h_layer entry
@return 0 on success, -1 on error
```

### receiver/module2/nn_impl.h


| Module | Functions |
|---|---|
| module2 | NN_IMPL_H |

#### NN_IMPL_H


```text
nn.h

Declarations for the neural network interface used in module2.
```

### receiver/module2/nn_params.c


| Module | Functions |
|---|---|
| module2 | default_nn_params |

#### default_nn_params


```text
Return a set of default neural network parameters.

The returned structure contains sensible defaults for hidden layer count,
learning rate and feature scales derived from the dataset. Scales map raw
values to the network's normalized domain by dividing raw values by the
corresponding scale factor.

@return initialized nn_params_t structure
```

### receiver/module2/nn_params.h


| Module | Functions |
|---|---|
| module2 | NN_PARAMS_H |

#### NN_PARAMS_H


```text
nn.h

Declarations for the neural network interface used in module2.
```

### receiver/module2/nn_thread.c


| Module | Functions |
|---|---|
| module2 | nn_thread, while |

#### nn_thread


```text
Neural-network processing thread entry point.

@param arg unused
```

#### while


```text
Main neural-network processing thread.

This thread consumes CSV-formatted lines from `proc_queue`, parses them
into `data_point_t`, runs the neural network to predict and optionally
trains the network online using the previous datapoint as input and the
current raw values as target. Predictions and debug strings are pushed
to `repr_queue`.
```

### receiver/module2/util.c


| Module | Functions |
|---|---|
| module2 | "util.h", denormalize_output, normalize_input |

#### "util.h"


```text
util.c

Normalize input features to [-1, 1] range using precomputed scales and from [-1, 1] back to raw values.
```

#### denormalize_output


```text
Denormalize neural network output from [-1, 1] range back to raw values using precomputed scales.

@param nn_params_t* params: pointer to nn_params_t containing scales
@param double* nn_out: pointer to neural network output array (length OUTPUT_SIZE)
@param float* out_raw: pointer to output array (length OUTPUT_SIZE) for denormalized raw values
```

#### normalize_input


```text
Normalize input features to [-1, 1] range using precomputed scales.

@param nn_params_t* params: pointer to nn_params_t containing scales
@param data_point_t* in: pointer to input data point (raw values)
@param double* out_norm: pointer to output array (length INPUT_SIZE) for normalized values
```

### receiver/module2/util.h


| Module | Functions |
|---|---|
| module2 | MODULE2_UTIL_H |

#### MODULE2_UTIL_H


```text
util.h

Declarations for utility functions for input normalization and denormalization in module2.
```

## module3


### receiver/module3/represent.c


| Module | Functions |
|---|---|
| module3 | represent_thread |

#### represent_thread


```text
Representation thread.

Reads formatted strings from `repr_queue` and writes them to the log for
human-readable representation. Returns when the queue is closed.

@param arg unused thread argument
```

### receiver/module3/represent.h


| Module | Functions |
|---|---|
| module3 | REPRESENT_H |

#### REPRESENT_H


```text
represent.h

Declarations for the representation thread in module3.
```

## module4


### receiver/module4/ui.c


| Module | Functions |
|---|---|
| module4 | ui_thread |

#### ui_thread


```text
UI thread function.

Consumes messages from the `error_queue` and logs them using the project's
logging facility. The function returns when the queue is closed.

@param arg unused thread argument
@return NULL
```

### receiver/module4/ui.h


| Module | Functions |
|---|---|
| module4 | UI_H |

#### UI_H


```text
ui.h

Declarations for the user interface thread in module4.
```

## core


### receiver/common.c


| Module | Functions |
|---|---|
| core | queue_close, queue_init, queue_pop, queue_push |

#### queue_close


```text
Close the queue and wake any waiting consumers.

After calling this, `queue_pop` will return NULL once the queue is empty.

@param q queue to close
```

#### queue_init


```text
Initialize a string queue.

Sets head/tail to NULL, initializes the mutex and condition variable and
clears the closed flag.

@param q pointer to the queue to initialize
```

#### queue_pop


```text
Pop a string from the queue.

This function blocks until an item is available or the queue is closed.
The returned pointer is owned by the caller and must be freed by the
caller when no longer needed. Returns NULL when the queue is closed and
empty.

@param q source queue
@return allocated string pointer or NULL
```

#### queue_push


```text
Push a copy of the string onto the queue.

The string is duplicated with strdup and owned by the queue; callers must
not free the provided pointer after calling this function.

@param q target queue
@param s NUL-terminated C string to push
```

### receiver/common.h


| Module | Functions |
|---|---|
| core | COMMON_H, { |

#### COMMON_H


```text
common.h

Common definitions for the receiver application, including thread-safe string queue structure and associated functions.
```

#### {


```text
Thread-safe string queue structure.

str_node_t *head: pointer to the head node
str_node_t *tail: pointer to the tail node
pthread_mutex_t m: mutex for synchronizing access
pthread_cond_t c: condition variable for signaling
int closed: flag indicating if the queue is closed
```

### receiver/io.c


| Module | Functions |
|---|---|
| core | *preproc_thread, run_receiver, safe_strncpy |

#### *preproc_thread


```text
Forward declaration for module1's preprocessing thread function expected by pthread_create. The implementation lives in module1 (data_processor.c / parser.c).
```

#### run_receiver


```text
Run the main receiver loop: initialize sockets, start pipeline threads, receive UDP messages and push them into the processing pipeline.
```

#### safe_strncpy


```text
Safe copy helper to avoid -Wstringop-truncation on strncpy and ensure NUL termination.

@param dst destination buffer
@param src source string
@param dst_size size of destination buffer
```

### receiver/io.h


| Module | Functions |
|---|---|
| core | RECEIVER_IO_H |

#### RECEIVER_IO_H


```text
io.h

Declarations for the main receiver I/O loop.
```

### receiver/log.c


| Module | Functions |
|---|---|
| core | log_close, log_fprintf, log_init |

#### log_close


```text
Release logging subsystem resources.
```

#### log_fprintf


```text
Thread-safe fprintf wrapper used by the project for serialized logging.

This function acquires the internal log lock, performs a vfprintf to the
provided FILE* and flushes the stream. If `f` is NULL the call is a no-op.

@param f FILE pointer to write to (e.g., stdout/stderr or a log file)
@param fmt printf-style format string
@param ... format arguments
```

#### log_init


```text
Initialize logging subsystem resources.
```

### receiver/log.h


| Module | Functions |
|---|---|
| core | RECEIVER_LOG_H |

#### RECEIVER_LOG_H


```text
log.h

Declarations for thread-safe logging functions used across the receiver application.
```

### receiver/main.c


| Module | Functions |
|---|---|
| core | <stdio.h>, main |

#### <stdio.h>


```text
main.c

Entrypoint for the receiver/analyzer program. This binary starts the
receive-and-process pipeline by calling the higher-level run_receiver()
implementation (see `common.c` / `io.c`).
```

#### main


```text
Program entrypoint.

This function forwards to run_receiver() which performs socket creation,
thread startup and the main receive loop.

@param argc count of command-line arguments (unused)
@param argv array of command-line arguments (unused)
@return return code from run_receiver()
```

### receiver/platform.c


| Module | Functions |
|---|---|
| core | platform_socket_cleanup, platform_socket_init |

#### platform_socket_cleanup


```text
Clean up platform-specific socket subsystem.
```

#### platform_socket_init


```text
Initialize platform-specific socket subsystem.

@return 0 on success, non-zero on failure
```

### receiver/platform.h


| Module | Functions |
|---|---|
| core | PLATFORM_H |

#### PLATFORM_H


```text
platform.h

Platform abstraction helpers (timing, sleep, platform-specific small utilities) used by the receiver.
```

### receiver/queues.c


| Module | Functions |
|---|---|
| core |  |

### receiver/queues.h


| Module | Functions |
|---|---|
| core | RECEIVER_QUEUES_H |

#### RECEIVER_QUEUES_H


```text
queues.h

Declarations for the shared queue instances used for inter-thread communication in the receiver pipeline.
```

### receiver/types.h


| Module | Functions |
|---|---|
| core | RECEIVER_TYPES_H, { |

#### RECEIVER_TYPES_H


```text
types.h

Common type definitions used across the receiver application and its modules.
```

#### {


```text
Received message structure representing a message received by the receiver.

ts: timestamp in milliseconds
payload: raw message payload
src_addr: source IP address as string
src_port: source port number
```

# sender


## core


### sender/net_logger.c


| Module | Functions |
|---|---|
| core | <stdio.h>, cmpstr, free_files, main |

#### <stdio.h>


```text
net_logger.c

Simple CSV/JSON sender used for testing the receiver pipeline. It reads
rows from CSV files (or a JSONL file) and sends them via UDP to a configured
server. Timing between rows can be accelerated for replay.
```

#### cmpstr


```text
Comparator for qsort that compares two filename pointers lexicographically.

Expects `a` and `b` to be pointers to `char*` and returns the same
semantics as strcmp so it can be passed directly to qsort.

@param a pointer to the first element (char**)
@param b pointer to the second element (char**)
@return negative, zero or positive value like strcmp
```

#### free_files


```text
Free an array of heap-allocated filename strings and the array itself.

If `files` is NULL this is a no-op. Otherwise each entry is freed and the
array container is freed as well.

@param files array of NUL-terminated strings allocated with malloc/strdup
@param n number of entries in the array
```

#### main


```text
Program entrypoint for the net logger.

Parses command-line options, enumerates input CSV/JSON files and streams
their rows over UDP to the configured server. Timing and repeat behaviour
are configurable via flags.

@param argc argument count
@param argv argument vector
@return 0 on success, non-zero on error
```